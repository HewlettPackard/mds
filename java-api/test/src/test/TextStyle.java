/*
 *
 *  Managed Data Structures
 *  Copyright Â© 2016 Hewlett Packard Enterprise Development Company LP.
 *
 *  This program is free software: you can redistribute it and/or modify
 *  it under the terms of the GNU Lesser General Public License as published by
 *  the Free Software Foundation, either version 3 of the License, or
 *  (at your option) any later version.
 *
 *  This program is distributed in the hope that it will be useful,
 *  but WITHOUT ANY WARRANTY; without even the implied warranty of
 *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 *  GNU Lesser General Public License for more details.
 *
 *  You should have received a copy of the GNU Lesser General Public License
 *  along with this program.  If not, see <http://www.gnu.org/licenses/>.
 *
 *  As an exception, the copyright holders of this Library grant you permission
 *  to (i) compile an Application with the Library, and (ii) distribute the 
 *  Application containing code generated by the Library and added to the 
 *  Application during this compilation process under terms of your choice, 
 *  provided you also meet the terms and conditions of the Application license.
 *
 */

package test;

public class TextStyle {
	private static final TextStyle BOLD = new TextStyle("1");
	private final String codes;
	
	enum Color {
		Black, Red, Green, Yellow, Blue, Magenta, Cyan, White;
		public final boolean blackContrast;
		public final TextStyle fg;
		public final TextStyle bg;
		Color(boolean blackContrast) {
			this.blackContrast = blackContrast;
			fg = new TextStyle("3"+ordinal());
			bg = new TextStyle("4"+ordinal());
		}
		Color() {
			this(false);
		}
		
		public TextStyle fg(Color bgColor) {
			return new TextStyle(fg, bgColor.bg);
		}
		public TextStyle bg(Color fgColor) {
			return fgColor.fg(this);
		}
		
	}
	
	private TextStyle(String... codes) {
		this.codes = String.join(";", codes);
	}
	
	private TextStyle(TextStyle prior, TextStyle then) {
		String pc = prior.codes;
		String tc = then.codes;
		if (pc.isEmpty()) {
			codes = tc;
		} else if (tc.isEmpty()) {
			codes = pc;
		} else {
			codes = pc+";"+tc;
		}
	}
	
	public String format(Object obj) {
		return "\033["+codes+"m"+obj.toString()+"\033[0m";
	}
	
	public TextStyle bold() {
		return new TextStyle(this, BOLD);
	}
}
